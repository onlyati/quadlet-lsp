{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"About Quadlet language server","text":"<p>This is an implementation of language server for Podman Quadlet files.</p> <p>Following features are currently available:</p> <ul> <li>Code completion</li> <li>Provide static completion based on Podman Quadlet documentation</li> <li>Query images, volumes, networks, pods, and so on, and provide completion     based on real configuration</li> <li>Hover menu</li> <li>Implemented \"go definition\" and \"go references\" functions</li> <li>Provide syntax checking</li> <li>Execute built-in commands</li> </ul> <p></p>"},{"location":"QSR001/","title":"QSR001 - Missing section header","text":""},{"location":"QSR001/#message","title":"Message","text":"<p>Missing any of these sections: %section_list%</p>"},{"location":"QSR001/#explanation","title":"Explanation","text":"<p>This is a Quadlet file, but lack of section headers:</p> <ul> <li>Image</li> <li>Container</li> <li>Volume</li> <li>Network</li> <li>Kube</li> <li>Pod</li> </ul>"},{"location":"QSR002/","title":"QSR002 - Unfinished line","text":""},{"location":"QSR002/#message","title":"Message","text":"<p>Line is unfinished</p>"},{"location":"QSR002/#explanation","title":"Explanation","text":"<p>This is error is reported when a keyword is used but nothing after equation sign.</p> <pre><code>[Container]\nImage=     # &lt;-- Error here because it is unfinished\nAutoUpdate=registry\n</code></pre>"},{"location":"QSR003/","title":"QSR003 - Invalid property","text":""},{"location":"QSR003/#message","title":"Message","text":"<p>Invalid property is found: %section%.%property_name%</p>"},{"location":"QSR003/#explanation","title":"Explanation","text":"<p>The typed property does not exists.</p> <pre><code>[Container]\nImage=docker.io/library/nextcloud:fpm\nAutoUpdat=registry # &lt;-- Invalid value at the left side of '='\n</code></pre>"},{"location":"QSR004/","title":"QSR004 - Image name is not fully qualified","text":""},{"location":"QSR004/#message","title":"Message","text":"<p>Image name is not fully qualified</p>"},{"location":"QSR004/#explanation","title":"Explanation","text":"<p>The specified image name is not fully qualified:</p> <pre><code>[Container]\nImage=debian:bookworm-slim\n</code></pre> <p>Use fully qualified image name instead. It means that the image must begin with <code>localhost</code> or with a valid address (e.g.: something.tld). It can also contains port number.</p> <p>Some examples:</p> <pre><code>Image=docker.io/library/debian:bookworm-slim\nImage=ghcr.io/henrygd/beszel/beszel-agent\nImage=localhost/test\nImage=localhost:5000/test\nImage=example.com:5000/test\n</code></pre>"},{"location":"QSR005/","title":"QSR005 - Invalid value of AutoUpdate","text":""},{"location":"QSR005/#message","title":"Message","text":"<p>Invalid value of AutoUpdate: %value%</p>"},{"location":"QSR005/#explanation","title":"Explanation","text":"<p>The <code>AutoUpdate</code> can only have <code>local</code> and <code>registry</code> values.</p>"},{"location":"QSR006/","title":"QSR006 - Image file does not exists","text":""},{"location":"QSR006/#message","title":"Message","text":"<p>Image file does not exists: %name%</p>"},{"location":"QSR006/#explanation","title":"Explanation","text":"<p>The specified <code>*.image</code> or <code>*.build</code> file does not exists that is used in the <code>Image=</code> line.</p>"},{"location":"QSR007/","title":"QSR007 - Invalid format of Environment variable","text":""},{"location":"QSR007/#message","title":"Message","text":"<p>Invalid format: %reason%</p>"},{"location":"QSR007/#explanation","title":"Explanation","text":"<p>Environment variables are represented as key-value pairs. If you need to assign a value containing spaces or the equals sign to a variable, put quotes around the whole assignment. Variable expansion is not performed inside the strings and the \"$\" character has no special meaning.</p> <p>This option may be specified more than once, in which case all listed variables will be set. If the same variable is listed twice, the later setting will override the earlier setting. If the empty string is assigned to this option, the list of environment variables is reset, all prior assignments have no effect.</p> <p>Correct examples:</p> <pre><code>Environment=FOO=BAR \"MyVar=MyValue\" 'foo=bar'\nEnvironment=FOO=\nEnvironment='fooVariable=barValue'\n</code></pre> <p>After <code>5.6.0</code> version, it accept environment variable without assignment. In this case, the value is get from the host.</p> <pre><code>Environment=FOO\n</code></pre>"},{"location":"QSR008/","title":"QSR008 - Invalid format of Annotation","text":""},{"location":"QSR008/#message","title":"Message","text":"<p>Invalid format: %reason%</p>"},{"location":"QSR008/#explanation","title":"Explanation","text":"<p>Annotation variables are represented as key-value pairs. If you need to assign a value containing spaces or the equals sign to a variable, put quotes around the whole assignment. Variable expansion is not performed inside the strings and the \"$\" character has no special meaning.</p> <p>This option may be specified more than once, in which case all listed variables will be set. If the same variable is listed twice, the later setting will override the earlier setting. If the empty string is assigned to this option, the list of environment variables is reset, all prior assignments have no effect.</p> <p>Correct examples:</p> <pre><code>Annotation=FOO=BAR \"MyVar=MyValue\" 'foo=bar'\nAnnotation=FOO=\nAnnotation='fooVariable=barValue'\n</code></pre>"},{"location":"QSR009/","title":"QSR009 - Invalid format of Label","text":""},{"location":"QSR009/#message","title":"Message","text":"<p>Invalid format: %reason%</p>"},{"location":"QSR009/#explanation","title":"Explanation","text":"<p>Label variables are represented as key-value pairs. If you need to assign a value containing spaces or the equals sign to a variable, put quotes around the whole assignment. Variable expansion is not performed inside the strings and the \"$\" character has no special meaning.</p> <p>This option may be specified more than once, in which case all listed variables will be set. If the same variable is listed twice, the later setting will override the earlier setting. If the empty string is assigned to this option, the list of environment variables is reset, all prior assignments have no effect.</p> <p>Correct examples:</p> <pre><code>Label=FOO=BAR \"MyVar=MyValue\" 'foo=bar'\nLabel=FOO=\nLabel='fooVariable=barValue'\n</code></pre>"},{"location":"QSR010/","title":"QSR010 - Incorrect format of PublishPort","text":""},{"location":"QSR010/#message","title":"Message","text":"<p>Incorrect format of PublishPort</p>"},{"location":"QSR010/#explanation","title":"Explanation","text":"<p>Valid formats for <code>PublishPort</code>:</p> <pre><code>PublishPort=10.0.0.1:10069:69\nPublishPort=10420:420\nPublishPort=443:443/tcp\nPublishPort=443:443/udp\nPublishPort=127.0.0.1:3000:3000/tcp\n</code></pre>"},{"location":"QSR011/","title":"QSR011 - Port is not exposed in image","text":""},{"location":"QSR011/#message","title":"Message","text":"<p>Port is not exposed in the image, exposed ports: %port_list%</p> <p>or</p> <p>Not able to verify exposed ports, because image not pulled: %image_list%</p>"},{"location":"QSR011/#explanation","title":"Explanation","text":"<p>Port is used in container or pod that is not exposed by the image. In case of pod, first it discover which other container files are linked for the pod and analyze those images.</p>"},{"location":"QSR012/","title":"QSR012 - Invalid format of secret specification","text":""},{"location":"QSR012/#message","title":"Message","text":"<p>Invalid format of secret specification: %reason%</p>"},{"location":"QSR012/#explanation","title":"Explanation","text":"<p>Depends on <code>reason</code> text:</p> <ul> <li><code>%opt% has no value</code>: Invalid option</li> <li><code>'type' can be either 'mount' or 'env'</code>: Target is specified but with invalid   value</li> <li><code>'%opt%' only allowed if type=mount</code>: Using <code>uid</code>, <code>gid</code> or <code>mode</code> meanwhile   not <code>type=env</code> is set</li> </ul>"},{"location":"QSR013/","title":"QSR013 - Volume file does not exists","text":""},{"location":"QSR013/#message","title":"Message","text":"<p>Volume file does not exists: %volume_file%</p>"},{"location":"QSR013/#explanation","title":"Explanation","text":"<p>The defined file, e.g.: <code>Volume=data.volume:/data</code>, does not exists in the current working directory.</p>"},{"location":"QSR014/","title":"QSR014 - Network file does not exists","text":""},{"location":"QSR014/#message","title":"Message","text":"<p>Network file does not exists: %network_file%</p>"},{"location":"QSR014/#explanation","title":"Explanation","text":"<p>The defined file, e.g.: <code>Network=my.network</code>, does not exists in the current working directory.</p>"},{"location":"QSR015/","title":"QSR015 - Invalid format of Volume specification","text":""},{"location":"QSR015/#message","title":"Message","text":"<p>Invalid format of Volume specification: %reason%</p>"},{"location":"QSR015/#explanation","title":"Explanation","text":"<p>Depends on the <code>reason</code>:</p> <ul> <li><code>container directory is not absolute</code>: Container directory must be absolute</li> <li><code>'%flag%' is unkown</code>: Not existing flag is used</li> </ul>"},{"location":"QSR016/","title":"QSR016 - Invalid value of UserNS specification","text":""},{"location":"QSR016/#message","title":"Message","text":"<p>Invalid value of UserNS: allowed values: %reason%</p>"},{"location":"QSR016/#explanation","title":"Explanation","text":"<p>Depends on the values of <code>reason</code>:</p> <ul> <li><code>%opt% has no paramerets</code>: Only <code>keep-id</code> can have further parameters</li> <li><code>[uid gid] allowed but found %opt%</code>: Uses <code>keep-id</code> with other parameters than   <code>uid</code> or <code>gid</code></li> <li><code>allowed values: [auto host keep-id nomap] but found %opt%</code>: Using invalid   value of <code>UserNS</code></li> </ul>"},{"location":"QSR017/","title":"QSR017 - Pod file does not exists","text":""},{"location":"QSR017/#message","title":"Message","text":"<p>Pod file does not exists: %pod_file%</p>"},{"location":"QSR017/#explanation","title":"Explanation","text":"<p>The defined file, e.g.: <code>Pod=my.pod</code>, does not exists in the current working directory.</p>"},{"location":"QSR018/","title":"QSR018 - Container cannot publish port with pod","text":""},{"location":"QSR018/#message","title":"Message","text":"<p>Container cannot have PublishPort because belongs to a pod: %pod_file%</p>"},{"location":"QSR018/#explanation","title":"Explanation","text":"<p>A Pod in Podman shares a network namespace across all containers inside it. The pod is the unit that binds to the host network (e.g., 127.0.0.1:8080), not the individual containers.</p> <p>Each container in the pod uses 127.0.0.1 to reach other containers in the same pod.</p>"},{"location":"QSR019/","title":"QSR019 - Container cannot have network with pod","text":""},{"location":"QSR019/#message","title":"Message","text":"<p>Container cannot have Network because belongs to a pod: %pod_file%</p>"},{"location":"QSR019/#explanation","title":"Explanation","text":"<p>When you create a pod, it gets a single network namespace that all containers in the pod share. So: Containers in the same pod communicate over localhost (127.0.0.1). You assign the network (e.g. --network) when creating the pod, not per container.</p>"},{"location":"QSR020/","title":"QSR020 - Naming of unit is invalid","text":""},{"location":"QSR020/#message","title":"Message","text":"<p>Invalid name of unit: %name%</p>"},{"location":"QSR020/#explanation","title":"Explanation","text":"<p>Container, Volume, Pod and Network naming must match with <code>^[a-zA-Z0-9][a-zA-Z0-9_.-]*$</code> regular expression. The specified name at <code>ContainerName</code>, <code>VolumeName</code>, <code>PodName</code> or <code>Networkname</code> does not match with the expression.</p>"},{"location":"QSR021/","title":"QSR021 - Unit points to not a systemd unit","text":""},{"location":"QSR021/#message","title":"Message","text":"<p>Invalid depdency is specified: %dependency%</p>"},{"location":"QSR021/#explanation","title":"Explanation","text":"<p>Quadlet will automatically translate dependencies, specified in the keys <code>Wants</code>, <code>Requires</code>, <code>Requisite</code>, <code>BindsTo</code>, <code>PartOf</code>, <code>Upholds</code>, <code>Conflicts</code>, <code>Before</code> and <code>After</code> of the <code>[Unit]</code> section, between different Quadlet units.</p> <p>But this is true only after <code>5.5.0</code> version. This rule gives error if dependency not translated and version if before <code>5.5.0</code>.</p> <p>For example the <code>fedora.container</code> unit below specifies a dependency on the <code>basic.container</code> unit.</p> <pre><code>print(\"Hello\")\n</code></pre> <pre><code>[Unit]\nAfter=basic.container\nRequires=basic.container\n\n[Container]\nImage=registry.fedoraproject.org/fedora:41\n</code></pre> <p>Before <code>5.5.0</code> version, file above should look:</p> <pre><code>[Unit]\nAfter=basic-container.service\nRequires=basic-container.service\n\n[Container]\nImage=registry.fedoraproject.org/fedora:41\n</code></pre>"},{"location":"QSR022/","title":"QSR022 - '/' is before systemd directory specifier","text":""},{"location":"QSR022/#message","title":"Message","text":"<p>Specifier, %specifier%, already starts with '/' sign</p>"},{"location":"QSR022/#explanation","title":"Explanation","text":"<p>The specifier is a directory and it already begin with <code>/</code> sign. For example <code>/%T</code> would evaluate as <code>//tmp</code> which is invalid path.</p>"},{"location":"QSR023/","title":"QSR023 - Invalid systemd specifier is used","text":""},{"location":"QSR023/#message","title":"Message","text":"<p>Specifier '%specifier%' is invalid</p>"},{"location":"QSR023/#explanation","title":"Explanation","text":"<p>Specifier does not exists: specifiers. If you want to write '%' then escape it as '%%'.</p>"},{"location":"QSR024/","title":"QSR024 - Not recommended property usage in Service section","text":""},{"location":"QSR024/#message","title":"Message","text":"<p>Usage in rootless podman is not recommended: Service.%property%</p>"},{"location":"QSR024/#explanation","title":"Explanation","text":"<p>Note that Quadlet units do not support running as a non-root user by defining the User, Group, or DynamicUser systemd options. If you want to run a rootless Quadlet, you will need to create the user and add the unit file to one of the above rootless unit search paths.</p> <p>If this is a rootful Podman, you can ignore the message.</p>"},{"location":"QSR025/","title":"QSR025 - Image is missing in container","text":""},{"location":"QSR025/#message","title":"Message","text":"<p>Container Quadlet file does not have Image property</p>"},{"location":"QSR025/#explanation","title":"Explanation","text":"<p>The <code>Image</code> property is mandatory to specify in container Quadlet files.</p>"},{"location":"QSR026/","title":"QSR026 - Artifact is missing in artifact","text":""},{"location":"QSR026/#message","title":"Message","text":"<p>Artifact Quadlet file does not have Artifact property</p>"},{"location":"QSR026/#explanation","title":"Explanation","text":"<p>The <code>Artifact</code> property is mandatory to specify in artifact Quadlet files.</p>"},{"location":"development/","title":"Development documentation","text":"<p>This is a language server for Podman Quadlets. Purpose of this language server is to provide a simple and easy way to modify Quadlet files.</p> <p>Basically this language server is also designed to work with Quadlets without running them. For example, Quadlets are in a repository, it is pulled and modified, but not directly run on the developer machine but on a server. In this situation, language server can help with syntax rules to provide better way to validate the files. Because of this, language server does not assume that user is working in <code>~/.config/containers/systemd</code> directory. It checks files in the current working directory of IDE, which information is sent by IDE during <code>initialize</code> call.</p> <p>Besides language server nature, this also can be used in CI/CD to check syntax of Quadlet files, by using <code>check</code> parameter.</p> <p>Following key features are supported:</p> <ul> <li>Completion: Provide static completion (e.g. keywords) and also provide   dynamic completions (e.g.: listing currently existing volumes).</li> <li>Hover: Provide explanation for keywords and values for better   understanding of Quadlet.</li> <li>Go definition/Go reference: Quadlets are split to multiple files, not like   compose files. This split makes it easier to read, since they are shorter. But   it makes also more difficult because it required to move among files. The   <code>go definition</code> and <code>go reference</code> features can help to navigate to the proper   file.</li> <li>Commands: Commands that can be useful, like pull down all images.</li> <li>Extra options: Like disable syntax rules or specify Podman version (in   case of the deployment server has different Podman than the developer   machine). These are done by <code>.quadletrc.json</code> file in the root working   directory.</li> </ul> <p>This project uses tliron/glsp 3.16 LSP implementation.</p>"},{"location":"development/#getting-started","title":"Getting started","text":"<p>For simplicity this project uses mise. Visit the website about installation. The <code>mise.toml</code> file contains the uses go version which is picked up by <code>mise</code> with the proper terminal integration.</p> <p>You can use the following <code>mise tasks</code> to easily perform actions:</p> <pre><code>$ mise task ls\nName       Description\nbuild      Build languager server to your system\nbuild_all  Make an offline release\nlint       Check linting\ntest       Run unit tests\n</code></pre> <p>The <code>build_all</code> command uses <code>goreleaser</code> but this is included as tool onto <code>mise.toml</code> file. The lint option uses <code>golangci-lint</code> but it also included into <code>mise.toml</code> file.</p>"},{"location":"development/#project-structure","title":"Project structure","text":"<p>Documents are stored in the memory of language server and they are modified during <code>TextDocumentDidOpen</code>, <code>TextDocumentDidChang</code> and <code>TextDocumentDidClose</code> calls.</p> <p>All components (e.g.: syntax, hover) are read the documents here, from the memory of the language server.</p>"},{"location":"development/#syntax-rules","title":"Syntax rules","text":"<p>Quadlet Syntax Rules (QSR) are in <code>internal/syntax</code> directory. The file name must match with the syntax rule identifier. For example, for <code>QSR021</code> you must have:</p> <ul> <li><code>internal/syntax/qsr021.go</code>: Store the logic.</li> <li><code>internal/syntax/qsr021_test.go</code>: Store unit tests for syntax rule.</li> <li><code>internal/syntax/syntax.go</code>: Register rule to the <code>NewSyntaxChecker</code> function.</li> </ul> <p>The <code>internal/syntax/common.go</code> has a function called <code>canFileBeApplied</code>. This should be called to verify which file extension are eligible for the syntax check.</p> <p>Then file is scanned using <code>utils.ScanQadlet</code> function. This function has the following parameters:</p> <ul> <li>document text: Full text of the document.</li> <li>podman version: This version is passed down to the action parameter. If   the subject is independent from the version, then placeholder is enough.</li> <li>selector map: specify a <code>map[utils.ScanProperty]struct{}</code> hash set which   line the action should run. If action needs to be called at all lines, then   map must have a <code>utils.ScanProperty{ Section: \"*\", Property: \"*\" }</code> element.</li> <li>action: This action doing the main part of the syntax check. This action is   called every line that is filtered by line.</li> <li>extraInfo: Via this parameter any data can be passed to action.</li> </ul> <p>Example for syntax rule:</p> <pre><code>func qsr024(s SyntaxChecker) []protocol.Diagnostic {\n    diags := []protocol.Diagnostic{}\n\n    allowedFiles := []string{\n        \"image\",\n        \"container\",\n        \"volume\",\n        \"network\",\n        \"kube\",\n        \"pod\",\n        \"build\",\n    }\n    if c := canFileBeApplied(s.uri, allowedFiles); c != \"\" {\n        diags = utils.ScanQadlet(\n            s.documentText,\n            // Placeholder here, but actual can be read from `s.config.Podman`\n            utils.PodmanVersion{},\n            map[utils.ScanProperty]struct{}{\n                {Section: \"[Service]\", Property: \"User\"}:        {},\n                {Section: \"[Service]\", Property: \"Group\"}:       {},\n                {Section: \"[Service]\", Property: \"DynamicUser\"}: {},\n            },\n            qsr024Action,\n            nil,\n        )\n    }\n\n    return diags\n}\n</code></pre> <p>The action function must have parameters like this.</p> <pre><code>func qsr024Action(q utils.QuadletLine, _ utils.PodmanVersion, _ any) []protocol.Diagnostic {\n    // Do syntax validation logic here\n\n    // One or more diagnostic element can be send back, sample:\n    return []protocol.Diagnostic{\n        {\n            Range: protocol.Range{\n                Start: protocol.Position{Line: q.LineNumber, Character: 0},\n                End:   protocol.Position{Line: q.LineNumber, Character: q.Length},\n            },\n            Severity: &amp;warnDiag,\n            Message:  fmt.Sprintf(\"Usage in rootless podman is not recommended: %s.%s\", \"Service\", q.Property),\n            Source:   utils.ReturnAsStringPtr(\"quadlet-lsp.qsr024\"),\n        },\n    }\n}\n</code></pre> <p>Don't forget to write unit tests to validate the functions and update <code>docs/qsr.md</code> file accordingly.</p>"},{"location":"development/#hover","title":"Hover","text":"<p>For static completion the <code>internal/data/properties.go</code> file is used. It has map structures that hold information and completion is suggested based on this. For example, we have this item in the map, in the <code>Container</code> section:</p> <pre><code>PropertyMapItem {\n    Label: \"DNS\",\n    Hover: []string{\n        \"Set network-scoped DNS resolver/nameserver for containers in this network.\",\n        \"\",\n        \"This key can be listed multiple times.\",\n        \"\",\n        \"For example:\",\n        \"```systemd\",\n        \"DNS=1.1.1.1\",\n        \"DNS=1.0.0.1\",\n        \"```\",\n    },\n    Parameters: []string{\n        \"1.1.1.1\",\n        \"1.0.0.1\",\n        \"8.8.8.8\",\n        \"8.8.4.4\",\n        \"9.9.9.9\",\n        \"149.112.112.112\",\n    },\n},\n</code></pre> <p>Language server will provide property completion if there is no <code>=</code> sign in the line yet. If the line start with <code>DNS=</code> and the <code>Parameters</code> list is not null, then provide their values as completion. By this, static completion is done purely on data basis.</p> <p>For dynamic completions that requires more logic (e.g.: listing secrets, cursor position matter), then it must be place into a separate file, like <code>internal/completion/property_image.go</code> and corresponding unit test (<code>internal/completion/property_image_test.go</code>).</p> <p>The completion function must has parameters and return value, like:</p> <pre><code>func propertyListImages(s Completion) []protocol.CompletionItem {\n    var completionItems []protocol.CompletionItem\n\n    // Do the logic here\n\n    return completionItems\n}\n</code></pre> <p>That the completion function is triggered, it must be registers in <code>listPropertyCompletions</code> function in <code>internal/completion/property.go</code> file.</p> <p>Don't forget to write unit tests and update <code>docs/features.md</code> file accordingly.</p>"},{"location":"development/#commands","title":"Commands","text":"<p>The commander module is not finalized, it will be probably redesigned in the near future.</p>"},{"location":"development/#contribution","title":"Contribution","text":"<p>All contribution are welcomed, not just PRs but also issues to highlight issues or new potential features in the project.</p>"},{"location":"features/","title":"Features","text":"<p>Features below are implemented to support following file extensions:</p> <ul> <li><code>*.image</code></li> <li><code>*.contianer</code></li> <li><code>*.volume</code></li> <li><code>*.network</code></li> <li><code>*.kube</code></li> <li><code>*.pod</code></li> <li><code>*.build</code></li> <li><code>*.artifact</code></li> </ul> <p>Language server also support the drop-ins directories. For example having <code>foo.container</code>. Settings can be override or added in a drop-ins file like <code>foo.container.d/10-ports.conf</code>. On this way settings can be override without changing the actual Quadlet files.</p> <p>About the language server</p> <p>Only Quadlet part has features in the files below. The generic systemd related parts are not covered.</p>"},{"location":"features/#built-in-commands","title":"Built-in commands","text":"<p>Language server provides some command that can be called from IDEs.</p> <ul> <li>List which background tasks are running</li> <li>Name: listJobs</li> <li>Neovim command: <code>QuadletListJobs</code></li> <li>VS Code command: <code>Quadlet: List activities</code></li> <li>Looking for all images in the directory and pull them down</li> <li>Name: pullAll</li> <li>Neovim command: <code>QuadletPullAll</code></li> <li>VS Code command: <code>Quadlet: Pull All</code></li> <li>Generate documentation</li> <li>Name: generateDoc</li> <li>Neovim command: <code>QuadletGenerateHTML</code>, <code>QuadletGenerateMd</code>,     <code>QuadletGenerateJSON</code></li> <li>VS Code command: <code>Quadlet: Generate HTML</code>, <code>Quadlet: Generate Markdown</code>,     <code>Quadlet: Generate JSON</code></li> </ul>"},{"location":"features/#syntax-checking","title":"Syntax checking","text":"<p>The language server performs syntax checking over the files. For more details, check Quadlet Syntax Rules.</p>"},{"location":"features/#disable-syntax-rule-per-file","title":"Disable syntax rule per file","text":"<p>It is possible to suspend specific QSR rules on file and on directory level. On directory level you must edit the <code>.quadletrc.json</code> file, see configuration file.</p> <p>On file level, it must be specified at the beginning of file. If line starts with <code># disable-qsr:</code> or <code>; disable-qsr:</code> and followed by specific QSR code, they do not be checked on specific file. See an example.</p> <pre><code># disable-qsr: qsr004\n\n[Container]\nImage=library/postgres:17\n</code></pre> <p>You can put more QSR codes to one line, you can create multiple lines, both config below are valid.</p> <pre><code># disable-qsr: qsr003 qsr021\n[Unit]\nDescription=...\n</code></pre> <pre><code># disable-qsr: qsr003 qsr021\n# disable-qsr: qsr018\n[Unit]\nDescription=...\n</code></pre>"},{"location":"features/#configuration-file","title":"Configuration file","text":"<p>If <code>.quadletrc.json</code> file exists in the current working directory, then some settings can be override.</p> <ul> <li><code>disable</code>: A string array, if any syntax checker source can be found here that   is ignored.</li> <li><code>podmanVersion</code>: Podman version can be specified. It can be useful if you want   to make Quadlets to another system where older Podman running than on your   current machine. If omitted, then it try to automatically discover based on   <code>podman version</code> command. If failed, then assumes you are using the highest   version.</li> </ul>"},{"location":"features/#project-settings","title":"Project settings","text":"<p>If the project itself is not just a Quadlet project, a root directory can be specified as <code>project.rootDir</code> in the configuration file. Result is, that the root directory where the language server work and looking for files will be a subdirectory of the project. This is useful, if you just provide Quadlets for installation but this is an application project.</p> <p>There is another settings, called <code>project.dirLevel</code>, which defaults to 2. Language server recursively looking for Quadlet files. Without any limitation, this could be end like an expensive and slow search. For this reason this settings has been made.</p>"},{"location":"features/#example-for-file","title":"Example for file","text":"<pre><code>{\n  \"disable\": [\"qsr013\", \"qsr004\"],\n  \"podmanVersion\": \"5.4.0\",\n  \"project\": {\n    \"rootDir\": \"container/quadlets\",\n}\n</code></pre>"},{"location":"features/#format-file","title":"Format file","text":"<p>Language server has feature to format the document. Format has the following rules:</p> <ul> <li>Line width does not exceed the 80 character width. If a line is longer, then   line is split by using <code>\\</code> continuation sign.</li> <li>Each comment line is removed, except from the beginning of the file.</li> <li>Properties are grouped based on topics.</li> <li>Within the topics, settings are sorted based on alphabetical order.</li> </ul> <p>Example formatted file:</p> <pre><code># disable-qsr: qsr014 qsr013\n#\n# File name: gitea.container\n\n[Unit]\nDescription=Gitea application\nStartLimitIntervalSec=90\nStartLimitBurst=5\nWants=gitea-db.service\n\n[Container]\n# Base options\nAutoUpdate=registry\nImage=docker.io/gitea/gitea:latest-rootless\nPod=gitea.pod\n\n# Storage options\nVolume=/etc/localtime:/etc/localtime:ro\nVolume=/etc/timezone:/etc/timezone:ro\n\n# Environment options\nEnvironment=GITEA__database__DB_TYPE=postgres\nEnvironment=GITEA__database__HOST=127.0.0.1\nEnvironment=GITEA__database__NAME=gitea\nEnvironment=GITEA__database__USER=gitea\n\n# Secret options\nSecret=gitea-db-password,type=env,target=GITEA__database__PASSWD\nSecret=gitea-smtp-password,type=env,target=GITEA__mailer__PASSWD\n\n# Healthcheck options\nHealthCmd=/bin/curlcurl -k --fail --connect-timeout 5 \\\n  https://127.0.0.1:3000/api/healthz\nHealthRetries=10\nHealthStartPeriod=15s\nHealthTimeout=15s\n\n# Other options\nLogDriver=journald\nUserNS=keep-id\n\n[Service]\nRestart=on-failure\nRestartSec=2\n\n[Install]\nWantedBy=default.target\n</code></pre>"},{"location":"features/#hover-menu","title":"Hover menu","text":""},{"location":"features/#hover-on-properties","title":"Hover on properties","text":"<p>Provide some information about specific property. See a demo about a container file in the following video.</p> <p></p> <p>Besides, following property values has hover explanation:</p> <ul> <li><code>UserNS</code></li> <li><code>Volume</code> (including flags)</li> <li><code>Secret</code></li> </ul>"},{"location":"features/#hover-on-systemd-specifiers","title":"Hover on systemd specifiers","text":"<p>The systemd specifiers can be used in Quadlets. Language server provide hover functionality for them.</p> <p></p>"},{"location":"features/#peek-into-quadlets","title":"Peek into Quadlets","text":"<p>If the hover is done on a value that points to another Quadlet at <code>Network</code>, <code>Pod</code> or <code>Volume</code> value, it peek into the file and display on hover.</p> <p></p>"},{"location":"features/#completion","title":"Completion","text":""},{"location":"features/#starter-template","title":"Starter template","text":"<p>The <code>newContainer</code>, <code>newVolume</code>, and so on, provide a started template for specific files.</p> <p></p>"},{"location":"features/#static-completion","title":"Static completion","text":"<p>Language server provide some static completion based on Podman Quadlet Documentation, like <code>Exec</code>, <code>Environment</code>, and so on.</p> <p></p>"},{"location":"features/#templates","title":"Templates","text":"<p>Some property has a \"new template\". If you type them you can get predefined snippets. Currently supported new templates:</p> <ul> <li><code>Annotation</code></li> <li><code>AddHost</code></li> <li><code>Environment</code></li> <li><code>Label</code></li> <li><code>PublishPort</code></li> <li><code>Secret</code></li> <li><code>Volume</code></li> </ul> <p></p>"},{"location":"features/#dynamic-completion","title":"Dynamic completion","text":"<p>Language server provide some dynamic completion:</p> <ul> <li>List pulled images and <code>*.image</code> files at <code>Image=</code></li> <li>List defined secrets at <code>Secret=</code>. Also further parameters (type, target)</li> <li>List created volumes and <code>*.volume</code> files at <code>Volume=</code>. Also further   parameters (rw, ro, z, Z)</li> <li>List <code>*.pod</code> files at <code>Pod=</code></li> <li>List created networks and <code>*.network</code> files at <code>Network=</code></li> <li>Gather and list <code>uid</code> and <code>gid</code> from image if <code>UserNS=keep-id:</code> is specified</li> <li>Gather exposed ports from image and provide them when <code>PublishPort</code> is   specified. In case of pod, it gather all images exposed ports.</li> <li>List systemd specifier (e.g.: <code>%h</code>, <code>%t</code>, <code>%n</code>) whenever write '%' sign</li> </ul> <p></p>"},{"location":"features/#go-definitionreferences","title":"Go definition/references","text":"<p>If you are on a line that points to another file, e.g.: <code>Pod=nc.pod</code> and using the <code>go definition</code> function, the file is open.</p> <p>If you are on a line like <code>[Pod]</code>, <code>[Volume]</code>, <code>[Network]</code>, <code>[Image]</code>, then current work directory is searched for any references to that specific file.</p> <p></p>"},{"location":"features/#alternate-usage","title":"Alternate usage","text":"<p>This binary can be used as a CLI syntax checker for Quadlet files. This can be useful, for example in CI/CD pipeline to verify Quadlets before packaging and later deploying.</p> <p>Same rule applied for CLI that is also applied for editor syntax checking. The <code>.quadletrc.json</code> file is also used on same way.</p> <p>Example for usage, that monitor the current working directory:</p> <pre><code>$ quadlet-lsp check .\nnc-db.container     , quadlet-lsp.qsr003, 09.000-09.010, Invalid property is found: Container.Memory\nnc-app.container    , quadlet-lsp.qsr003, 08.000-08.010, Invalid property is found: Container.Memory\n$ echo $?\n4\n</code></pre>"},{"location":"install_and_plugins/","title":"Installation &amp; Plugins","text":""},{"location":"install_and_plugins/#plugins","title":"Plugins","text":"<p>Language server can be used with various code editors out of the box:</p> <ul> <li>Neovim</li> <li>VS Code</li> <li>Zed (3rd party)</li> </ul>"},{"location":"install_and_plugins/#download","title":"Download","text":"<p>If you would like to use it with Neovim or as a CLI, there are several source where it can be installed. The VS Code and Zed plugins are already contains the language server.</p> MiseFedoraDebian/Ubuntu.deb and .rpm packagesnix flakego install <p>Easy to download and use it with mise.</p> <pre><code>mise use -g github:onlyati/quadlet-lsp\n</code></pre> <p>This is supported on Fedora 43, RHEL 10, Alma Linux 10, Rocky Linux 10.</p> <pre><code>sudo dnf copr enable onlyati/quadlet-lsp\nsudo dnf install quadlet-lsp\n</code></pre> <p>This method is supported for Debian 13. Add the following registry, that hosted by me, then update:</p> <pre><code>$ sudo curl \\\n    https://git.thinkaboutit.tech/api/packages/pandora/debian/repository.key \\\n    -o /etc/apt/keyrings/gitea-pandora.asc\n$ sudo tee /etc/apt/sources.list.d/onlyati.sources &gt; /dev/null &lt;&lt;'EOF'\nTypes: deb\nURIs: https://git.thinkaboutit.tech/api/packages/pandora/debian\nSuites: trixie\nComponents: main\nSigned-By: /etc/apt/keyrings/gitea-pandora.asc\nEOF\n$ sudo apt update\n</code></pre> <p>Then simply install:</p> <pre><code>sudo apt install quadlet-lsp\n</code></pre> <p>Check GitHub release page and download the version you need, then install it manually.</p> <p>Add this repo to your flake's inputs.</p> <pre><code>inputs = {\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-25.05\";\n    quadlet-lsp.url = \"github:onlyati/quadlet-lsp\";\n};\n</code></pre> <p>Add the default package to your packages list.</p> <pre><code>environment.systemPackages = [\n    inputs.quadlet-lsp.packages.${system}.default\n];\n\n# Home Manager\nhome.packages = [\n    inputs.quadlet-lsp.packages.${system}.default\n];\n</code></pre> <p>You can also install the binary using Go.</p> <pre><code>go install github.com/onlyati/quadlet-lsp@latest\n</code></pre>"},{"location":"install_and_plugins/#download-compiled-binary","title":"Download compiled binary","text":"<pre><code>Check GitHub [release page](https://github.com/onlyati/quadlet-lsp/releases) and\ndownload the version you need. The archive contains only the binary of language\nserver.\n\nOn Linux, you can get it quicker from terminal. See example commands.\n\n```bash\nARCH=\"amd64\"\nOS=\"linux\"\nLATEST_VERSION=$(curl -s -H \"Accept: application/vnd.github+json\" \\\n    https://api.github.com/repos/onlyati/quadlet-lsp/releases/latest \\\n    | jq -r .tag_name)\nrm quadlet-lsp-${LATEST_VERSION}-${OS}-${ARCH}.tar.gz\nwget \"https://github.com/onlyati/quadlet-lsp/releases/download/${LATEST_VERSION}/quadlet-lsp-${LATEST_VERSION}-${OS}-${ARCH}.tar.gz\"\nsudo tar -xvf \"quadlet-lsp-${LATEST_VERSION}-${OS}-${ARCH}.tar.gz\" \\\n    -C /usr/local/bin/\n```\n</code></pre>"}]}